<html>
<head>
    <meta charset="utf-8">

    <link rel="stylesheet" href="index.css">
    <script>
        
         var person
        function myFunction() {
  person = prompt("Por favor, insira seu nome", "Harry Potter");
  if (!person == "") {
      
    document.getElementById("demo").innerHTML=person;
  }
  else{
    myFunction() 

  }
}  var cont;
        var name = document.getElementById.value;
        var ws = new WebSocket('ws://'+window.document.location.host);
        var content = document.createElement('div');
        content.classList.add('BoxChat');
        ws.onmessage=function(message){
        console.log('teste',message ,cont);
        if(cont!=1){
            console.log('dd' ,cont);
        if(message.data != null){
        content.innerHTML += '<div Class='+'CardMessageConvidad'+'>'
            +'<div Class='+'ContentUsername'+'>'+
                '<div Class='+'TextMessage'+'>'+
                    '<p Class='+'TextCard'+'>'+message.data+'</p></div>'
                    '<div Class='+'ContentData'+'>'+
                    '<p Class='+'TextMessageData'+'>'+'20:20'+'</p>'+'</div></div></br>';
        document.getElementById('messages').append(content)
        }
        cont=0
    }else{
        console.log('rodale' ,cont);
        content.innerHTML += '<div Class='+'CardMessageUser'+'>'+
                '<div Class='+'TextMessage'+'>'+
                    '<p Class='+'TextCard'+'>'+message.data+'</p></div>'
                    '<div Class='+'ContentData'+'>'+
                    '<p Class='+'TextMessageData'+'>'+'20:20'+'</p>'+'</div></div></br>';
        document.getElementById('messages').append(content)
    }

    cont=0
    
    }
       
        //sendMessage()
        function sendMessage(){
        
        if(!person){
            myFunction();
        }else{
            var msg=document.getElementById('msgBox').value;
            document.getElementById('msgBox').value='';
            if(!msg){
                alert("Escreva no campo menssagem para enviar.")
            }else{
        var data = new Date() 
        var from = person;
        var time = data.getHours() + ':' +  data.getMinutes() + ':' + data.getSeconds().toString();
        var mensagem = `[${time}] [${from}]: ${msg}` ;
        cont=1;
        // content.innerHTML += message+'</br>';
        console.log(mensagem );
    content.scrollTo(0, 1000);
        
        ws.send(mensagem );
        }}
    }
</script>
</head>
<body>
    <div class="Container">
<div class="SideLeft">
    <p class="Title">CHAT-REDIS</p>
    <label class="TextLabelUser" id="demo"></label>
    <button onclick="myFunction()"class="InputMessage" >Configuração</button>
    <div class="CardChat">
        <img src="../assests/image/icon.png"/>
    </div>
</div>
<div class="SideRight">
    <p class="Title">CHAT-REDIS</p>
    <div class="BoxChat"  id='messages'>

    </div>
<input type='text' placeholder='Escreva sua mensagem' id='msgBox' class="InputMessage">
<input type='button' onclick='sendMessage()' value='Enviar' class="InputMessage"/>
</div>
</div>

</body>

</html>